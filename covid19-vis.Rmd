---
title: "covid19"
author: "B. Levine"
date: "3/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
```

## COVID-19 JHU Visualizations

```{r init, echo=FALSE, include=FALSE}
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(data.table))
theme_set(theme_gray(14))
theme_update(legend.position='top')
# read in JHU data
# transpose the colums/rows
# set type column to confirmed" (or deaths or recovered)
# rename columns
confirmed<- fread("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv") %>% 
	as.tbl %>%
	gather(date, val, -`Province/State`,-`Country/Region`,-Lat ,-Long) %>%
	mutate(date=mdy(date),type='confirmed') %>%
	rename('province'=`Province/State`,region=`Country/Region`)

deaths<- read_csv("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Deaths.csv") %>% 
	gather(date, val, -`Province/State`,-`Country/Region`,-Lat ,-Long) %>%
	mutate(date=mdy(date),type='deaths') %>%
	rename('province'=`Province/State`,region=`Country/Region`)

recovered<- read_csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Recovered.csv')%>% 
	gather(date, val, -`Province/State`,-`Country/Region`,-Lat ,-Long) %>%
	mutate(date=mdy(date),type='recovered') %>%
	rename('province'=`Province/State`,region=`Country/Region`)

# bind all rows together
covid<- bind_rows(confirmed,deaths,recovered)%>% filter(val>0)
```

## World data

```{r pressure, echo=FALSE}

# All three lines for the world
ggplot(covid %>% group_by(date,type) %>% summarize(val=sum(val)))+
	aes(date,val,group=type,color=type)+
	geom_line()+geom_point()+
	scale_y_continuous(label=comma,breaks=pretty_breaks(10))+
	scale_x_date(breaks=pretty_breaks(10))+
	labs(x="")
```


